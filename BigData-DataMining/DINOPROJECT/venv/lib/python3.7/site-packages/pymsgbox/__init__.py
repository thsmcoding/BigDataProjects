# PyMsgBox - A simple, cross-platform, pure Python module for JavaScript-like message boxes.
# By Al Sweigart al@inventwithpython.com

__version__ = '1.0.7'

# Modified BSD License
# Derived from Stephen Raymond Ferg's EasyGui http://easygui.sourceforge.net/

"""
The four functions in PyMsgBox:

 - alert(text='', title='', button='OK')

    Displays a simple message box with text and a single OK button. Returns the text of the button clicked on.

 - confirm(text='', title='', buttons=['OK', 'Cancel'])

    Displays a message box with OK and Cancel buttons. Number and text of buttons can be customized. Returns the text of the button clicked on.

 - prompt(text='', title='' , default='')

    Displays a message box with text input, and OK & Cancel buttons. Returns the text entered, or None if Cancel was clicked.

 - password(text='', title='', default='', mask='*')

    Displays a message box with text input, and OK & Cancel buttons. Typed characters appear as *. Returns the text entered, or None if Cancel was clicked.
"""

"""
TODO Roadmap:
- Be able to specify a custom icon in the message box.
- Be able to place the message box at an arbitrary position (including on multi screen layouts)
- Add mouse clicks to unit testing.
- progress() function to display a progress bar
- Maybe other types of dialog: open, save, file/folder picker, etc.
"""

import sys
RUNNING_PYTHON_2 = sys.version_info[0] == 2

# Because PyAutoGUI requires PyMsgBox but might be installed on systems
# without tkinter, we don't want a lack of tkinter to cause installation
# to fail. So exceptions won't be raised until the PyMsgBox functions
# are actually called.
TKINTER_IMPORT_SUCCEEDED = True

try:
    if RUNNING_PYTHON_2:
        import Tkinter as tk
    else:
        import tkinter as tk

    rootWindowPosition = '+300+200'

    if tk.TkVersion < 8.0 :
        raise RuntimeError('You are running Tk version: ' + str(tk.TkVersion) + 'You must be using Tk version 8.0 or greater to use PyMsgBox.')

except ImportError:
    TKINTER_IMPORT_SUCCEEDED = False



PROPORTIONAL_FONT_FAMILY = ('MS', 'Sans', 'Serif')
MONOSPACE_FONT_FAMILY    = ('Courier')

PROPORTIONAL_FONT_SIZE  = 10
MONOSPACE_FONT_SIZE     =  9  #a little smaller, because it it more legible at a smaller size
TEXT_ENTRY_FONT_SIZE    = 12  # a little larger makes it easier to see


STANDARD_SELECTION_EVENTS = ['Return', 'Button-1', 'space']

# constants for strings: (TODO: for internationalization, change these)
OK_TEXT        = 'OK'
CANCEL_TEXT    = 'Cancel'
YES_TEXT       = 'Yes'
NO_TEXT        = 'No'
RETRY_TEXT     = 'Retry'
ABORT_TEXT     = 'Abort'
IGNORE_TEXT    = 'Ignore'
TRY_AGAIN_TEXT = 'Try Again'
CONTINUE_TEXT  = 'Continue'

TIMEOUT_RETURN_VALUE = 'Timeout'

# Initialize some global variables that will be reset later
__choiceboxMultipleSelect = None
__widgetTexts = None
__replyButtonText = None
__choiceboxResults = None
__firstWidget = None
__enterboxText = None
__enterboxDefaultText=''
__multenterboxText = ''
choiceboxChoices = None
choiceboxWidget = None
entryWidget = None
boxRoot = None
buttonsFrame = None





def _alertTkinter(text='', title='', button=OK_TEXT, root=None, timeout=None):
    """Displays a simple message box with text and a single OK button. Returns the text of the button clicked on."""
    assert TKINTER_IMPORT_SUCCEEDED, 'Tkinter is required for pymsgbox'
    retVal = _buttonbox(msg=text, title=title, choices=[str(button)], root=root, timeout=timeout)
    if retVal is None:
        return button
    else:
        return retVal
alert = _alertTkinter


def _confirmTkinter(text='', title='', buttons=(OK_TEXT, CANCEL_TEXT), root=None, timeout=None):
    """Displays a message box with OK and Cancel buttons. Number and text of buttons can be customized. Returns the text of the button clicked on."""
    assert TKINTER_IMPORT_SUCCEEDED, 'Tkinter is required for pymsgbox'
    return _buttonbox(msg=text, title=title, choices=[str(b) for b in buttons], root=root, timeout=timeout)
confirm = _confirmTkinter


def _promptTkinter(text='', title='' , default='', root=None, timeout=None):
    """Displays a message box with text input, and OK & Cancel buttons. Returns the text entered, or None if Cancel was clicked."""
    assert TKINTER_IMPORT_SUCCEEDED, 'Tkinter is required for pymsgbox'
    return __fillablebox(text, title, default=default, mask=None,root=root, timeout=timeout)
prompt = _promptTkinter


def _passwordTkinter(text='', title='', default='', mask='*', root=None, timeout=None):
    """Displays a message box with text input, and OK & Cancel buttons. Typed characters appear as *. Returns the text entered, or None if Cancel was clicked."""
    assert TKINTER_IMPORT_SUCCEEDED, 'Tkinter is required for pymsgbox'
    return __fillablebox(text, title, default, mask=mask, root=root, timeout=timeout)
password = _passwordTkinter


# Load the native versions of the alert/confirm/prompt/password functions, if available:
if sys.platform == 'win32':
    from . import _native_win
    NO_ICON  = 0
    STOP     = 0x10
    QUESTION = 0x20
    WARNING  = 0x30
    INFO     = 0x40
    alert   = _native_win.alert
    confirm = _native_win.confirm


def timeoutBoxRoot():
    global boxRoot, __replyButtonText, __enterboxText
    boxRoot.destroy()
    __replyButtonText = TIMEOUT_RETURN_VALUE
    __enterboxText = TIMEOUT_RETURN_VALUE


def _buttonbox(msg, title, choices, root=None, timeout=None):
    """
    Display a msg, a title, and a set of buttons.
    The buttons are defined by the members of the choices list.
    Return the text of the button that the user selected.

    @arg msg: the msg to be displayed.
    @arg title: the window title
    @arg choices: a list or tuple of the choices to be displayed
    """
    global boxRoot, __replyButtonText, __widgetTexts, buttonsFrame


    # Initialize __replyButtonText to the first choice.
    # This is what will be used if the window is closed by the close button.
    __replyButtonText = choices[0]

    if root:
        root.withdraw()
        boxRoot = tk.Toplevel(master=root)
        boxRoot.withdraw()
    else:
        boxRoot = tk.Tk()
        boxRoot.withdraw()

    boxRoot.title(title)
    boxRoot.iconname('Dialog')
    boxRoot.geometry(rootWindowPosition)
    boxRoot.minsize(400, 100)

    # ------------- define the messageFrame ---------------------------------
    messageFrame = tk.Frame(master=boxRoot)
    messageFrame.pack(side=tk.TOP, fill=tk.BOTH)

    # ------------- define the buttonsFrame ---------------------------------
    buttonsFrame = tk.Frame(master=boxRoot)
    buttonsFrame.pack(side=tk.TOP, fill=tk.BOTH)

    # -------------------- place the widgets in the frames -----------------------
    messageWidget = tk.Message(messageFrame, text=msg, width=400)
    messageWidget.configure(font=(PROPORTIONAL_FONT_FAMILY, PROPORTIONAL_FONT_SIZE))
    messageWidget.pack(side=tk.TOP, expand=tk.YES, fill=tk.X, padx='3m', pady='3m')

    __put_buttons_in_buttonframe(choices)

    # -------------- the action begins -----------
    # put the focus on the first button
    __firstWidget.focus_force()

    boxRoot.deiconify()
    if timeout is not None:
        boxRoot.after(timeout, timeoutBoxRoot)
    boxRoot.mainloop()
    try:
        boxRoot.destroy()
    except tk.TclError:
        if __replyButtonText != TIMEOUT_RETURN_VALUE:
            __replyButtonText = None

    if root: root.deiconify()
    return __replyButtonText


def __put_buttons_in_buttonframe(choices):
    """Put the buttons in the buttons frame"""
    global __widgetTexts, __firstWidget, buttonsFrame

    __firstWidget = None
    __widgetTexts = {}

    i = 0

    for buttonText in choices:
        tempButton = tk.Button(buttonsFrame, takefocus=1, text=buttonText)
        _bindArrows(tempButton)
        tempButton.pack(expand=tk.YES, side=tk.LEFT, padx='1m', pady='1m', ipadx='2m', ipady='1m')

        # remember the text associated with this widget
        tã ⁄∞ ‡î § ∞ ∞ Bº OÏ dtã â∞ èƒ ∑‘ √∞ …‡ Ò ˛Ï tã 8∞ >¸ f sÏ àtã ≠∞ ≥ €( Ê Îtã 	Ñ 	H (	Ä R	Ñ W	à m	4 {	L Ü	@ í	ºã ü	ƒã •	T µ	h ƒ	Ãã Õ	ÿã ”	| „	ê Ú	‘ã ˚	¿ã 
§ 
∏  
Ã+ &
‘ 4
Ë Y
@  x  lã & \ ? Ã D lã T pã f x r d ö tã ü Ãã • ÿã µ x Ã Ãã ¯ lã ˛ –ã pã 2x ?lã I\ b– glã wpã âx ïd Ωtã ¬ºã »ƒã ÿx Ôºã lã !–ã 8pã Ux blã l\ Ö‘ älã ôÿ ûpã ¥¨ πtã ◊xã ‡lã Ëx pã !x .lã 8\ Q‹ Vlã dH npã étã ólã Æpã ∆lã €lã ƒã ÿã ¿ã L "ºã 'Ãã ,‘ã 6L Atã P‘ã Y¿ã _h v‡ {xã ÜÃã èÿã;	PO D	TO I	êO Q	`O W	åO ]	\O Ò
òX µòX YòX ˝òX óòX ãòX  ˇˇ0û 
 é $ 0û K é |  ± ÄX ﬁ lX ¸ lX  àû ®‚â æP AP WPàxX çàX õàX ≠xX ∑pX ÀpX ‘àX Ò¥û  ¥û 6xX <àX hxX qàX {pX äpX ƒX 4ƒX måX ìåX úåX ≤åX ªÄX √∞X ˝ÄX 	ÄX œdO ÿòX QdO W4O ehO k8O ùlO £<O ÕtO ”DO ·xO ÁHO ˘|O ˛LO 	àO 	àO 	XO  	pO %	@O 1	ÑO 6	ÄO 2åX 8òX =∏X WÑX ÑtX ä†X êtX úhX ª¥X ¬¥û ÷¿X „òX È®X ı§X ¨X  ¿X &®X 6§X Q¨X a¿X g®X y§X Ö¨X ç¿X 8O +<O 6HO A§X FDO PLO gTO t®X yXO Ö\O í¨X Ï4Z Û4a ˘pX ˇxX àX pX #8Z /0Z >pX IpX w8Z ~8Z õ8Z ≤8Z π8Z ¿8Z «8Z —4Z ‹<Z Ê4Z Ó<Z !pX &4Z  @8f∞X nƒX wÑX |åX äêX ùîX ©†X µúX øÄX ƒdX Œ|X ”lX €êX ¯tX ˛†X tX dO ºX hX "ƒX (»X -ÃX sòX €úX ÚúX 	úX 'PO ,òX :@O E`O ñòX  úà+¥û &êX ,òX 5îX  E(Ì†X tX  3$?dW  D$RdW WºX vÃX ì»X ¥∏X ù†X ªtX ‰ºX ˇÃX »X =∏X ¥¥û  ∫,¿òX   (j†X ÃtX ‚êX ıîX  ˚, $‰W &‰V LºX gÃX Å»X °∏X }	†X ﬂ	tX ı	êX 
îX 
ºX *
ÃX G
»X c
∏X …
“X “
–X 4O ˇxX 	àX c	àX m	pX {	pX π	¥û »	¥û ÿ	¥û Ë	¥û °
xX ß
àX  ∫
4æƒ
xX …
àX ]àX fpX ÷xX ·àX ÕàX pàX zpX ëxX õpX œ¥û ‚¥û ˆ¥û  4à+ Wå+ fê+ Ü4æ∆÷X Ã‘X S ¥X  £ Ä ™ ` È Ñ#8¥û QtX  d4ûÉêX §îX ƒêX ‰îX ÍºX ˚»X ÃX ∏X xX $àX 1àX eàX npX xxX }pX ÁÑX Û|X ˛¥~  4ûi4^ †ÑX ≤|X ƒÄX ﬁ∞X ¥é Ÿ¥û Ë¥û ¯¥û ÖxX ãàX ÊxX ÔàX ˘pX pX J¥û Y¥û i¥û y¥û ?xX LàX YàX ÃàX ÷pX ËpX ÓxX -¥û <¥û L¥û ‹xX ‚àX  ı4æ †X ›tX êX 7îX A†X atX xêX ∫îX Ë†X ˚tX êX SîX Å†X îtX ™êX ÏîX  xX  àX  , 4æ6 xX ; àX • pX Æ àX ¥ pX  ¥û ¥û '¥û ;¥û  áà+ ∞å+ øê+ ﬂ4æ0÷X 6‘X {xX ÅàX  †4æ•xX ™àX &àX 0pX >pX è¥û ¢¥û ∂¥û  Úà+ å+ ê+ ?4æ÷X Ö‘X ‡xX ÊàX xX  4æbpX qpX ÄàX –¥û „¥û ˜¥û ¥û  rà+ ïå+ §ê+ ƒ4æ÷X ‘X ÅxX áàX ¢xX  ß4æ'àX 1pX ?pX @	†X D»X W∏X áxX çàX õ‘X ´÷X rxX ÉpX ààX ìpX π†X  ºX $ ÃX 0 »X C ∏X t xX à àX ñ ‘X † ÷X làX vpX àpX éxX ∏†X Ì†X  tX êX 5îX ;†X \tX rêX ¢îX Õ†X ‡tX ˆêX îX FºX VÃX f»X v∏X óxX úàX ©‘X ∏÷X 8àX BpX LxX RpX x†X ◊
†X Í
tX  êX "îX ,†X QtX hêX †îX ﬁ†X ÒtX êX \îX ì†X ¶tX ºêX ÙîX ºX 1ÃX _	ÑX n	|X ë	|X ®	ÿX ¥	‰X ¿	‹X ”	‡X Ì	¥ ¢
|X ’
¥ à|X sÑX Ç|X •|X ºÿX »‰X ‡¥ ◊|X ﬂ|X $¥ Ÿ †X Ï tX êX  îX *†X DtX ZêX êîX ≤†X ≈tX ‹êX îX 8ºX HÃX T»X d∏X âxX èàX ö‘X ©÷X #xX -àX 7pX FpX sÿX {‰X ôÿX ¢‰X ¡‹X «‡X ‡¥^ Ê‰X ÎÿX ¯ÿX ‰X %‰X ,4^ 1ÿX U‰X \4^ aÿX Ö‰X å4^ ëÿX µ‰X º4^ ¡ÿX ˛ÑX |X 0|X GÿX S‰X e¥ €|X ¥ W|X œ¥~ Ï¥~ 	¥~ &¥~ C¥~ `¥~ }¥~ ö¥~ ∆¥~ ÂÄX ¥ ÄX "∞X 3¥~ \ÑX ëÑX ôÑX   |X ( |X ∆ÑX ’|X ¯|X ÿX ‰X '‹X :‡X T¥ é|X ñ|X Û¥ $|X ,|X ®∂ ØÄX µ∞X ‘ÑX ‹ÑX ÄX '¥ .ÄX 4∞X D¥^ iÑX ìÑX jÄX õ¥~ ©∂ ∞ÄX ∂∞X œÑX ◊ÑX ü	ÄX Ã	¥ ”	ÄX Ÿ	∞X 
ÑX <
ÑX D
ÑX ≠ÄX ›¥ ‰ÄX Í∞X ÑX _ÑX gÑX Ë¥~ ¥~ !¥~ >¥~ [¥~ x¥~ ï¥~ ≤¥~ òX é†X †tX ∞êX ∂ºX ŒÃ